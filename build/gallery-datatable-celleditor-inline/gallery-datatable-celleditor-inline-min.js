YUI.add("gallery-datatable-celleditor-inline",function(e,t){var n=27,r=13,i=9,s=38,o=40,u=39,a=37;e.DataTable.BaseCellInlineEditor=e.Base.create("celleditor",e.View,[],{template:'<input type="text" class="{cssInput}" />',events:{input:{keypress:"processKeyPress",keydown:"processKeyDown",click:"_onClick",mouseleave:"_onMouseLeave"}},_subscr:null,_cssInput:"yui3-datatable-inline-input",_inputNode:!1,initializer:function(){return this._createUI(),this._bindUI(),this},destructor:function(){this._unbindUI(),this.fire("editorDestroyed")},_bindUI:function(){this.publish({save:{defaultFn:this._defSaveFn},cancel:{defaultFn:this._defCancelFn},show:{defaultFn:this._defShowFn}}),this._subscr=[],this._subscr.push(this.on("xyChange",this._setEditorXY))},_unbindUI:function(){e.Array.each(this._subscr,function(e){e&&e.detach&&e.detach()}),this._subscr=null},_defSaveFn:function(e){this.set("value",e.newValue),this.hideEditor()},_defCancelFn:function(){this.hideEditor()},_defShowFn:function(e){var t=this.get("container"),n=e.cell,r=n.td||e.td,i=r.getXY(),s=e.value;t.show(),this._resizeCont(t,r),t.setXY(i),this._inputNode.focus(),this._inputNode.set("value",s),this.set("lastValue",s),this._set("visible",!0),this._set("hidden",!1)},showEditor:function(e){var t=this.get("cell"),n=t.value||this.get("value"),r=this.get("prepFn");r&&(n=r.call(this,n)),this.fire("show",{td:e,cell:t,inputNode:this._inputNode,value:n})},saveEditor:function(e){if(e!==undefined&&e!==null){var t=this.get("saveFn");t&&(e=t.call(this,e));if(e===undefined){this.cancelEditor();return}this.fire("save",{td:this.get("cell").td,cell:this.get("cell"),oldValue:this.get("lastValue"),newValue:e})}},hideEditor:function(e){var t=this.get("container");t&&t.hide&&t.hide(),e===!0&&this._set("hidden",!0),this._set("visible",!1),this.fire("editorHide")},cancelEditor:function(){this.fire("cancel",{td:this.get("cell").td,cell:this.get("cell"),oldValue:this.get("lastValue")})},processKeyPress:function(t){var n=t.keyCode,i=t.target||this._inputNode,s=i.get("value"),o=this.get("keyFiltering"),u=String.fromCharCode(n),a=!0,f;n===r&&(t.preventDefault(),this.saveEditor(s)),o instanceof RegExp?a=u.match(o)?a:!1:e.Lang.isFunction(o)&&(f=o.call(this,t),a=f?!0:!1),a||t.preventDefault()},processKeyDown:function(e){var t=e.keyCode,r;switch(t){case n:e.preventDefault(),this.cancelEditor();break;case s:r=e.ctrlKey?[-1,0]:null;break;case o:r=e.ctrlKey?[1,0]:null;break;case a:r=e.ctrlKey?[0,-1]:null;break;case u:r=e.ctrlKey?[0,1]:null;break;case i:r=e.shiftKey?[0,-1]:[0,1]}r&&(this.get("inputKeys")===!0&&this._set("keyDir",r),e.preventDefault())},_createUI:function(){var t=this.get("container"),n=e.Lang.sub(this.template,{cssInput:this._cssInput});t.setHTML(n),t.inDoc()||e.one("body").append(t),t.setStyle("zIndex",999),t.hide(),this._inputNode=t.one("input"),this.get("className")&&this._inputNode.addClass(this.get("className")),this.fire("editorCreated",{inputNode:this._inputNode,container:t})},_resizeCont:function(e,t){var n=this._parseStyle(t,"width"),r=this._parseStyle(t,"height"),i=this._parseStyle(t,"paddingLeft"),s=this._parseStyle(t,"paddingTop"),o=this._parseStyle(t,"borderLeftWidth");n+=i+o-1,r+=s,e.setStyle("width",n+"px"),e.setStyle("height",r+"px")},_parseStyle:function(e,t){return+e.getComputedStyle(t).replace(/px/,"")},_onClick:function(e){e.stopPropagation()},_onMouseLeave:function(){this.get("hideMouseLeave")&&this.hideEditor()},_setEditorXY:function(){this.hideEditor()}},{ATTRS:{name:{value:null,validator:e.Lang.isString},cell:{valueFn:function(){return{}}},value:{value:null},lastValue:{value:null},hostDT:{value:null,validator:function(t){return t instanceof e.DataTable}},prepFn:{value:null,validator:e.Lang.isFunction},saveFn:{value:null,validator:e.Lang.isFunction},hideMouseLeave:{value:!0,validator:e.Lang.isBoolean},className:{value:null,validator:e.Lang.isString},inputKeys:{value:!0,validator:e.Lang.isBoolean},keyDir:{value:[],readOnly:!0,validator:e.Lang.isArray},visible:{value:!1,readOnly:!0,validator:e.Lang.isBoolean},hidden:{value:!1,readOnly:!0,validator:e.Lang.isBoolean},xy:{value:null,validator:e.Lang.isArray},keyFiltering:{value:null},validator:{value:null}}}),e.DataTable.EditorOptions.inline={BaseViewClass:e.DataTable.BaseCellInlineEditor,name:"inline"},e.DataTable.EditorOptions.inlineNumber={BaseViewClass:e.DataTable.BaseCellInlineEditor,name:"inlineNumber",hideMouseLeave:!1,keyFiltering:/\.|\d|\-/,validator:/^\s*(\+|-)?((\d+(\.\d*)?)|(\.\d*))\s*$/,saveFn:function(e){var t=this.get("validator"),n;return t instanceof RegExp?n=t.test(e)?+e:undefined:n=+e,n}},e.DataTable.EditorOptions.inlineDate={BaseViewClass:e.DataTable.BaseCellInlineEditor,name:"inlineDate",dateFormat:"%D",keyFiltering:/\/|\d|\-/,prepFn:function(t){var n=this.get("dateFormat")||"%m/%d/%Y";return e.DataType.Date.format(t,{format:n})},saveFn:function(t){return e.DataType.Date.parse(t)||undefined}},e.DataTable.EditorOptions.inlineAC={BaseViewClass:e.DataTable.BaseCellInlineEditor,name:"inlineAC",hideMouseLeave:!1,after:{editorCreated:function(t){var n=t.inputNode,r=this.get("autocompleteConfig")||{},i=this;n&&e.Plugin.AutoComplete&&(r=e.merge(r,{alwaysShowList:!0,render:!0}),n.plug(e.Plugin.AutoComplete,r),n.ac.editor=i)}}}},"@VERSION@",{supersedes:[""],skinnable:"true",requires:["gallery-datatable-editable","view","base-build","event-mouseenter"],optional:[""]});
